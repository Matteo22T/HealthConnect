<div class="calendar-container">

  <div class="calendar-header">
    <div class="btn-group">
      <button
        class="btn btn-primary"
        mwlCalendarPreviousView
        [view]="view"
        [(viewDate)]="viewDate">
        Indietro
      </button>
      <button
        class="btn btn-outline-secondary"
        mwlCalendarToday
        [(viewDate)]="viewDate">
        Oggi
      </button>
      <button
        class="btn btn-primary"
        mwlCalendarNextView
        [view]="view"
        [(viewDate)]="viewDate">
        Avanti
      </button>
    </div>

    <h3>{{ viewDate | date:'MMMM yyyy' }}</h3>
  </div>

  <br>

  <mwl-calendar-week-view
    [viewDate]="viewDate"
    [events]="events"
    [refresh]="refresh"
    [dayStartHour]="8"
    [dayEndHour]="20"
    [tooltipTemplate]="tooltipDisabled"
    (eventClicked)="openEventPopup($event.event)">
  </mwl-calendar-week-view>

  <ng-template #tooltipDisabled></ng-template>

  @if (selectedEvent) {
    <div class="modal-overlay" (click)="closePopup()">
      <div class="modal-content" (click)="$event.stopPropagation()">
        <button class="close-btn" (click)="closePopup()">âœ•</button>

        <div class="modal-header">
          <h2>Dettaglio Visita</h2>
        </div>

        <div class="modal-body">
          <div class="info-row">
            <span class="label">ğŸ“… Data:</span>
            <span class="value">{{ selectedEvent.start | date:'dd/MM/yyyy' }}</span>
          </div>

          <div class="info-row">
            <span class="label">ğŸ• Orario:</span>
            <span class="value">{{ selectedEvent.start | date:'HH:mm' }} - {{ selectedEvent.end | date:'HH:mm' }}</span>
          </div>

          <div class="info-row">
            <span class="label">ğŸ‘¤ Paziente:</span>
            <span class="value">{{ selectedEvent.meta?.paziente?.nome }} {{ selectedEvent.meta?.paziente?.cognome }}</span>
          </div>

          <div class="info-row">
            <span class="label">ğŸ“‹ Motivo:</span>
            <span class="value">{{ selectedEvent.meta?.motivo }}</span>
          </div>
        </div>

      </div>
    </div>
  }

</div>
